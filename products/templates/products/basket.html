{% extends "products/base.html" %}
{% load static %}

{% block content %}
	<div class="col-lg-5" style="margin: 0 auto; padding-top: 100px;">
		{% if messages %}
			<div class="mt-3 position-fixed" style="z-index: 1050; top: 20px; right: 20px; width: 300px;">
				{% for message in messages %}
					<div class="alert {% if message.tags %}alert-{{ message.tags }}{% else %}alert-info{% endif %} alert-dismissible fade show" role="alert">
						{{ message }}
					</div>
				{% endfor %}
			</div>
    	{% endif %}
		{% if basket_items %}
			<h4 class="mt-3 mb-3 d-flex justify-content-between align-items-center mb-3">
				Корзина <span class="badge badge-secondary badge-pill">Количество товаров: {{ count }}</span>
			</h4>
			{% for basket_item in basket_items %}
				<div class="card mb-3">
					<div class="card-body d-flex justify-content-between">
						<div style="max-width: 350px">
							<h5 class="card-title">{{ basket_item.product.name }}</h5>
							<p class="card-text">{{ basket_item.product.description }}</p>
						</div>
						<div>
							<a href="#">
								<img class="card-img-top" style="max-width: 300px"
									src="{{ basket_item.product.image.url }}"
									alt="image of product">
							</a>
						</div>
					</div>
					<ul class="list-group list-group-flush">
						<li class="list-group-item bg-light">
							<div class="row text-center d-flex align-items-center">
								<form action="{% url "products:update_basket_item_quantity" %}" method="post">
									{% csrf_token %}
									<input name="basket_item_id" type="hidden" value="{{ basket_item.pk }}">
									<input name="quantity" type="number" class="form-control" value="{{ basket_item.quantity }}" min="0" onchange="this.form.submit()"``>
								</form>
								<div class="col-lg-4">{{ basket_item.total_price }} руб.</div>
								<form action="{% url "products:delete_bakset_item" %}" method="post">
									{% csrf_token %}
									<input type="hidden" name="basket_item_id" value={{ basket_item.pk }}>
									<button type="submit">Удалить из корзины <i class="fas fa-trash"></i></button>
								</form>
								{% comment %} <div class="col-lg-4">
									<a href="#">
										Удалить из корзины <i class="fas fa-trash"></i>
									</a>
								</div> {% endcomment %}
							</div>
						</li>
					</ul>
				</div>
			{% endfor %}
			<div class="card mb-3">
				<div class="card-footer d-flex justify-content-between align-items-center">
					<p class="float-left">Итого</p>
					<h4 class="float-right">{{ total }} руб.</h4>
				</div>
			</div>
			<a class="btn btn-success btn-lg float-right" href="../orders/order-create.html">
				Оформить заказ
			</a>
		{% else %}
			<h4 class="mt-3 mb-3 text-center">
				Корзина пуста
			</h4>
		{% endif %}
	</div>
{% endblock  %}

