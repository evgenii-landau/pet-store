{% extends "products/base.html" %}


{% block content %}
	<main>
		
	</main>

{% endblock %}


{% comment %} <div class="col-lg-5" style="margin: 0 auto; padding-top: 100px;">
    {% if messages %}
        <div class="mt-3 position-fixed" style="z-index: 1050; top: 20px; right: 20px; width: 300px;">
            {% for message in messages %}
                <div class="alert {% if message.tags %}alert-{{ message.tags }}{% else %}alert-info{% endif %} alert-dismissible fade show" role="alert">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}
    {% if basket_items %}
        <h4 class="mt-3 mb-3 d-flex justify-content-between align-items-center mb-3">
            –ö–æ—Ä–∑–∏–Ω–∞ <span class="badge badge-secondary badge-pill">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤: {{ count_items }}</span>
        </h4>
        {% for basket_item in basket_items %}
            <div class="card mb-3">
                <div class="card-body d-flex justify-content-between">
                    <div style="max-width: 350px">
                        <h5 class="card-title">{{ basket_item.product.name }}</h5>
                        <p class="card-text">{{ basket_item.product.description }}</p>
                    </div>
                    <div>
                        <a href="#">
                            <img class="card-img-top" style="max-width: 300px"
                                src="{{ basket_item.product.image.url }}"
                                alt="image of product">
                        </a>
                    </div>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item bg-light">
                        <div class="row text-center d-flex align-items-center">
                            <form action="{% url 'products:update_basket_item_quantity' %}" method="post">
                                {% csrf_token %}
                                <input name="basket_item_id" type="hidden" value="{{ basket_item.pk }}">
                                <input name="quantity" type="number" class="form-control" value="{{ basket_item.quantity }}" min="0" onchange="this.form.submit()">
                            </form>
                            <div class="col-lg-4">{{ basket_item.get_sum_price_items }} —Ä—É–±.</div>
                            <div class="col-lg-4">
                                <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ -->
                                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#deleteModal" data-item-id="{{ basket_item.pk }}">
                                    –£–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        {% endfor %}
        <div class="card mb-3">
            <div class="card-footer d-flex justify-content-between align-items-center">
                <p class="float-left">–ò—Ç–æ–≥–æ</p>
                <h4 class="float-right">{{ total_price }} —Ä—É–±.</h4>
            </div>
        </div>
        <a class="btn btn-success btn-lg float-right" href="../orders/order-create.html">
            –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
        </a>
    {% else %}
        <h4 class="mt-3 mb-3 text-center">
            –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞ üôÑ
        </h4>
    {% endif %}
</div> {% endcomment %}

{% comment %} <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteModalLabel">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è</h5>
            </div>
            <div class="modal-body">
                –í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="confirmDeleteButton">–£–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var deleteModal = document.getElementById('deleteModal');
        var confirmDeleteButton = document.getElementById('confirmDeleteButton');
        var itemId;

        deleteModal.addEventListener('show.bs.modal', function (event) {
            var button = event.relatedTarget;
            itemId = button.getAttribute('data-item-id');
        });

        confirmDeleteButton.addEventListener('click', function () {
            fetch(`{% url 'products:delete_basket_item' 0 %}`.replace('0', itemId), {
                method: 'POST',
                headers: {
                    'X-CSRFToken': '{{ csrf_token }}'
                }
            })
            .then(response => {
                if (response.ok) {
                    location.reload();
                } else {
                    alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–∞.');
                }
            });
        });
    });
</script> {% endcomment %}

